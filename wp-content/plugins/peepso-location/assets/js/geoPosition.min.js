function handleBlackBerryLocationTimeout(){-1!=bb.blackberryTimeoutId&&bb.error({message:"Timeout error",code:3})}function handleBlackBerryLocation(){if(clearTimeout(bb.blackberryTimeoutId),bb.blackberryTimeoutId=-1,bb.success&&bb.error){if(0==blackberry.location.latitude&&0==blackberry.location.longitude)bb.error({message:"Position unavailable",code:2});else{var a=null;blackberry.location.timestamp&&(a=new Date(blackberry.location.timestamp)),bb.success({timestamp:a,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb.success=null,bb.error=null}}var bb={success:0,error:0,blackberryTimeoutId:-1},geoPosition=function(){var a={},b=null,c="undefined",d="http://freegeoip.net/json/?callback=JSONPCallback";return a.getCurrentPosition=function(a,c,d){b.getCurrentPosition(a,c,d)},a.jsonp={callbackCounter:0,fetch:function(a,b){var c="JSONPCallback_"+this.callbackCounter++;window[c]=this.evalJSONP(b),a=a.replace("=JSONPCallback","="+c);var d=document.createElement("SCRIPT");d.src=a,document.getElementsByTagName("HEAD")[0].appendChild(d)},evalJSONP:function(a){return function(b){a(b)}}},a.confirmation=function(){return confirm("This Webpage wants to track your physical location.\nDo you allow it?")},a.init=function(){try{var e=typeof navigator.geolocation!=c;if(!e&&!a.confirmation())return!1;if(typeof geoPositionSimulator!=c&&geoPositionSimulator.length>0)b=geoPositionSimulator;else if(typeof bondi!=c&&typeof bondi.geolocation!=c)b=bondi.geolocation;else if(e)b=navigator.geolocation,a.getCurrentPosition=function(a,d,e){function f(b){var d;d=typeof b.latitude!=c?{timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude}}:b,a(d)}b.getCurrentPosition(f,d,e)};else if(typeof window.blackberry!=c&&blackberry.location.GPSSupported){if(typeof blackberry.location.setAidMode==c)return!1;blackberry.location.setAidMode(2),a.getCurrentPosition=function(a,b,c){bb.success=a,bb.error=b,c.timeout?bb.blackberryTimeoutId=setTimeout("handleBlackBerryLocationTimeout()",c.timeout):bb.blackberryTimeoutId=setTimeout("handleBlackBerryLocationTimeout()",6e4),blackberry.location.onLocationUpdate("handleBlackBerryLocation()"),blackberry.location.refreshLocation()},b=blackberry.location}else typeof Mojo!=c&&"Mojo.Service.Request"!=typeof Mojo.Service.Request?(b=!0,a.getCurrentPosition=function(a,b,c){parameters={},c&&(c.enableHighAccuracy&&1==c.enableHighAccuracy&&(parameters.accuracy=1),c.maximumAge&&(parameters.maximumAge=c.maximumAge),c.responseTime&&(c.responseTime<5?parameters.responseTime=1:c.responseTime<20?parameters.responseTime=2:parameters.timeout=3)),r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(b){a({timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude,heading:b.heading}})},onFailure:function(a){b(1==a.errorCode?{code:3,message:"Timeout"}:2==a.errorCode?{code:2,message:"Position unavailable"}:{code:0,message:"Unknown Error: webOS-code"+errorCode})}})}):typeof device!=c&&typeof device.getServiceObject!=c?(b=device.getServiceObject("Service.Location","ILocation"),a.getCurrentPosition=function(a,c,d){function e(b,d,e){4==d?c({message:"Position unavailable",code:2}):a({timestamp:null,coords:{latitude:e.ReturnValue.Latitude,longitude:e.ReturnValue.Longitude,altitude:e.ReturnValue.Altitude,heading:e.ReturnValue.Heading}})}var f=new Object;f.LocationInformationClass="BasicLocationInformation",b.ILocation.GetLocation(f,e)}):(a.getCurrentPosition=function(b,c,e){a.jsonp.fetch(d,function(a){b({timestamp:a.timestamp,coords:{latitude:a.latitude,longitude:a.longitude,heading:a.heading}})})},b=!0)}catch(f){return typeof console!=c&&console.log(f),!1}return null!=b},a}();